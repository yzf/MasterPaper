\begin{algorithm}\label{algo_ProperLoop}
\SetAlgoVlined
\SetKw{return}{return}\SetKw{Break}{break}
\SetKwInOut{Input}{输入}\SetKwInOut{Output}{输出}
\caption{正规逻辑程序特征环的识别算法$ProperLoop(L,P,S)$}
\Input{正依赖图中的环$L$，析取逻辑程序$P$，原子集合$S$}
\Output{若返回$L$，则$L$是特征环；否则，$L$不是特征环}

$G_P^S:=$原子集合$S$在$G_P$中的诱导子图；\\
$SCC:=G_P^S$的强连通分量的集合；\\
\For{$C \in SCC$} {
	\uIf{$C \subset L$且$R^-(C) \subseteq R^-(L)$} {
		\return $C$
	} 
	\ElseIf{$R^-(C) \ne \emptyset$且$R^-(C) \subset R^-(L)$} {
		\return $C$
	}
	\ElseIf{$R^-(C)=\emptyset$或$R^-(C)=R^-(L)$} {
		\For{$a \in C$} {
			$G^*:=$原子集合$C\backslash \{a\}$在$G^S_P$的诱导子图；\\
			$SCC^*:=G^*$的强连通分量的集合；\\
			把$SCC^*$里面的新元素加入到$SCC$；
		}
	}
	\Else {
		$G_C:=$原子集合$C\backslash head(R^-(C)\backslash R^-(L))$在$G^S_P$的诱导子图；\\
		$SCC_C:=G_C$的强连通分量的集合；\\
		把$SCC_C$里面的新元素加入到$SCC$；
	}
}
\return $L$
\end{algorithm}
