\begin{algorithm}\label{algo_CountingSort}
\SetKwData{Dis}{dis}
\SetKwFunction{CalculateHammingDistance}{CalculateHammingDistance}
\SetKw{downto}{downto}\SetKw{return}{return}
\SetKwInOut{Input}{输入}\SetKwInOut{Output}{输出}
\caption{基于计数排序的$k$近邻搜索}
\Input{查询向量$\mathbf{g} \in \{0, 1\}^q$，数据集$\mathcal{H} =
\{\mathbf{h}_i\}_{i = 1}^n$，$\mathbf{h}_i \in \{0, 1\}^q$，近邻数$k$}
\Output{在数据集$\mathcal{H}$中与查询向量$\mathbf{g}$海明距离最接近的
$k$个向量}
\For{$i \leftarrow 1$ \KwTo $m$}{
    $c[i] \leftarrow 0$
}
\For{$i \leftarrow 1$ \KwTo $n$}{
    \Dis $\leftarrow$ \CalculateHammingDistance{$\mathbf{g}, \mathbf{h}_i$} \\
    $A[i] \leftarrow <i, \Dis>$ \\
    $c[\Dis] \leftarrow c[\Dis] + 1$
}
\For{$i \leftarrow 1$ \KwTo $m$}{
    $c[i] \leftarrow c[i - 1] + c[i]$
}
\For{$i \leftarrow n$ \downto $1$}{
    $b[c[A[i].second]] \leftarrow A[i].first$ \\
    $c[A[i].second] \leftarrow c[A[i].second] - 1$
}
\return $b[1..k]$
\end{algorithm}
