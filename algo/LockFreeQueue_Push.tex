\begin{algorithm}\label{algo_LockFreeQueue_Push}
\SetKwInOut{Input}{输入}
\SetKwRepeat{DoWhile}{do}{while}
\SetKwFunction{Index}{Index}\SetKwFunction{CAS}{CAS}
\SetKwData{WriteCount}{write\_count\_}
\SetKwData{ReadCount}{read\_count\_}
\SetKwData{LastCommitCount}{last\_commit\_count\_}
\SetKwData{CurrentReadCount}{current\_read\_count}
\SetKwData{CurrentWriteCount}{current\_write\_count}
\SetKw{True}{true}\SetKw{False}{false}\SetKw{Return}{return}
\caption{无锁队列的push操作}
\Input{被push的元素$element$}
\DoWhile{not $\CAS(\&\WriteCount, \CurrentWriteCount, \CurrentWriteCount + 1)$}{
$\CurrentReadCount \leftarrow \ReadCount$ \\
$\CurrentWriteCount \leftarrow \WriteCount$ \\
// 如果队列已满，则操作失败，返回\False \\
\If{\Index($\CurrentWriteCount + 1$) = \Index(\CurrentReadCount)}{
\Return \False
}
}
$buffer\_[\Index(\CurrentWriteCount)] \leftarrow element$\\
设置内存栅栏 \\
$\LastCommitCount \leftarrow \LastCommitCount + 1$ \\
\Return \True
\end{algorithm}
