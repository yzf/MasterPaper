\begin{algorithm}\label{algo_MIHQuery}
\SetKwInOut{Substrings}{Query substrings}
\SetKwInOut{Radius}{Substring radius}
\caption{对查询向量$\mathbf{g}$的$r$近邻搜索}
\Substrings{$\{\mathbf{g}^{(j)}\}_{j = 1}^m$}
\Radius{$r' = \lfloor r / m \rfloor$，$a = r - mr'$}
\For{$j \leftarrow 1$ \KwTo $a + 1$}{
    Lookup $r'$-neighbors of $\mathbf{g}^{(j)}$ from $j^{th}$ hash table
}
\For{$j \leftarrow a + 2$ \KwTo $m$}{
    Lookup $(r' - 1)$-neighbors of $\mathbf{g}^{(j)}$ from $j^{th}$ hash table
}
Remove all non $r$-neighbors from the candidate set.
\end{algorithm}

