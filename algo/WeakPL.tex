\begin{algorithm}\label{algo_WeakPL}
\footnotesize
\SetAlgoVlined
\SetKw{return}{return}\SetKw{Break}{break}
\SetKwInOut{Input}{输入}\SetKwInOut{Output}{输出}
\caption{析取逻辑程序的弱特征环的识别算法$WPL(L,P)$}
\Input{正依赖图中的环$L$，正规逻辑程序$P$}
\Output{若返回$L$，则$L$在特征环超集里；若返回环$C$，则$L$不在特征环的超集里}

$SCC:=G_P$的强连通分量的集合\\
\For{$C \in SCC$} {
	\If{$C \subset L$且$R^-(C) \subseteq R^-(L)$} {
		\return $C$
	}
	\ElseIf{$head(R^-(C)) \cap C \subseteq head(R^-(L)) \cap L$且$R^-(C) \subset R^-(L)$} {
		\return $C$
	}
	\ElseIf{$R^-(C)=R^-(L)$} {
		\For{$a \in C$} {
			$G^*:=$原子集合$C \backslash \{a\}$在$G_P$的诱导子图\\
			$SCC^*:=G^*$的强连通分量的集合\\
			把$SCC^*$的所有新元素加入到$SCC$中
		}
	}
	\ElseIf{$head(R^-(C)) \cap C \nsubseteq head(R^-(L)) \cap L$且$C \nsubseteq L$} {
		$C':=C \backslash ((head(R^-(C)) \cap C) \backslash (head(R^-(L)) \cap L))$\\
		$G':=$原子集合$C'$在$G_P$的诱导子图\\
		$SCC':=G'$的强连通分量的集合\\
		把$SCC'$的所有新元素加入到$SCC$中
	}
	\Else {
		$G_C:=$原子集合$C \backslash head(R^-(C) \ R^-(L))$在$G_P$的诱导子图\\
		$SCC_C:=G_C$的强连通分量的集合\\
		把$SCC_C$的所有新元素加入到$SCC$中
	}
}
\return $L$
\end{algorithm}
