\begin{algorithm}\label{algo_Rearrange}
\SetKwInOut{Input}{输入}\SetKwInOut{Output}{输出}\SetKwInOut{Init}{初始化}
\SetKwFunction{CalculateRatio}{CalculateRatio}
\caption{优化算法――重排二进制码的0-1值顺序}
\Input{矩阵$\mathbf{H} \in \{0, 1\}^{n \times q}$}
\Output{矩阵$\mathbf{H}'$的每一行的值按映射重新排列}
\Init{$S = \{<0, \{\}>, ..., <0, \{\}>\}$}
\For{矩阵$\mathbf{H}$的每一列$\mathbf{c_i}$}{
    $f[i] \leftarrow \CalculateRatio(\mathbf{c_i})$
}
\For{$i \leftarrow 1$ \KwTo $q$}{
    $F[i] \leftarrow <i, f[i]>$
}
对数组$F$按其第二维从大到小排序 \\
$i \leftarrow 1$ \\
\While{$i \le q$}{
    对数组$S$按其第一维从小到大排序 \\
    \For{$j \leftarrow 1$ \KwTo $\min(m, q - i + 1)$}{
        $S[j].first \leftarrow S[j].first + F[i].second$ \\
        将$F[i].first$插入到$S[j].second$ \\
        $i \leftarrow i + 1$
    }
}
依次取出数组$S$第二维的所有元素作为列排列的顺序，对矩阵$\mathbf{H}$的每一行按照
此顺序重排列其0-1值，从而生成矩阵$\mathbf{H}'$
\end{algorithm}
